(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["2856cd5d"],{"655cd127":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return eV;}});var l=a("777fffbe"),r=a("852bbaa9"),s=a("1dda0c16"),o=a("6e3566fd"),n=r._(o),i=a("90ea153d"),d=l._(i),c=a("c1890b93"),u=l._(c),h=a("7dc1d35c"),x=l._(h),f=a("682f84e5"),g=l._(f),p=a("04463b55"),m=l._(p),j=a("33e07b31"),y=l._(j),b=a("fc4f973e"),v=l._(b),S=a("a3e2d47f"),C=l._(S),k=a("122b1322"),P=l._(k),F=a("8007f4eb"),E=l._(F),R=a("90c5995c"),Q=l._(R);let w=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,$=(e,t,a=2)=>parseFloat((Math.random()*(t-e)+e).toFixed(a)),T=(e=10)=>Array.from({length:e},()=>w(50,500)),N=(e,t)=>{let a=["GET","POST","PUT","DELETE"],l=["/api/users","/api/products","/api/orders","/api/auth","/api/search"];return{serviceName:e,path:l[t%l.length],method:a[t%a.length],currentQPS:w(50,300),maxQPS:w(300,800),avgQPS:$(100,400),totalRequests:w(1e3,1e4),totalErrors:w(0,100),errorRate:$(0,5),minResponseTime:`${w(10,50)}ms`,maxResponseTime:`${w(200,1e3)}ms`,avgResponseTime:`${w(50,300)}ms`,cacheHits:w(500,5e3),cacheMisses:w(100,1e3),cacheHitRate:$(70,95),cacheSize:w(1e3,1e4),qpsHistory:T(),websocket:Math.random()>.5?{connections:w(10,100),messages:w(1e3,1e4),errors:w(0,20)}:void 0,uptime:`${w(1,30)}\u{5929}${w(0,23)}\u{5C0F}\u{65F6}${w(0,59)}\u{5206}\u{949F}`,startTime:new Date(Date.now()-w(864e5,2592e6)).toISOString()};},H=e=>{let t=Array.from({length:w(5,15)},(t,a)=>N(e,a)),a=t.reduce((e,t)=>e+t.totalRequests,0),l=t.reduce((e,t)=>e+t.totalErrors,0),r=t.reduce((e,t)=>e+t.currentQPS,0),s=r/t.length,o=Math.max(...t.map(e=>e.maxQPS)),n=t.reduce((e,t)=>e+t.cacheHits,0),i=t.reduce((e,t)=>e+t.cacheMisses,0),d=t.some(e=>e.websocket);return{serviceName:e,totalRouters:t.length,publicRouters:w(2,t.length),privateRouters:w(1,t.length-2),manageRouters:w(1,3),totalRequests:a,totalErrors:l,totalQPS:r,avgQPS:s,maxQPS:o,totalCacheHits:n,totalCacheMisses:i,totalWSConnections:d?w(20,200):0,totalWSMessages:d?w(1e3,2e4):0,totalWSErrors:d?w(0,50):0,routers:t,collectedAt:new Date().toISOString()};},_=[H("\u7528\u6237\u670D\u52A1"),H("\u8BA2\u5355\u670D\u52A1"),H("\u5546\u54C1\u670D\u52A1"),H("\u652F\u4ED8\u670D\u52A1"),H("\u901A\u77E5\u670D\u52A1")];var O=a("0fbf6a42"),q=l._(O),I=a("8250539e"),M=l._(I),W=a("d4ad5b7c"),B=l._(W),D=a("edfc0bd1"),A=a("947119aa"),z=a("fb7f230b");a("166ecaa2");var L=a("4a187f71"),K=l._(L),U=a("d63f3740"),G=a("0b3f67ba"),V=a("44f2e78b"),X=a("fa7f3640"),J=a("07716bd1"),Y=a("bc2359a8");let Z=e=>{let{paddingXXS:t,lineWidth:a,tagPaddingHorizontal:l,componentCls:r,calc:s}=e,o=s(l).sub(a).equal(),n=s(t).sub(a).equal();return{[r]:Object.assign(Object.assign({},(0,X.resetComponent)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:o,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,G.unit)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${r}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${r}-close-icon`]:{marginInlineStart:n,fontSize:e.tagIconSize,color:e.colorIcon,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${r}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${r}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:o}}),[`${r}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}};},ee=e=>{let{lineWidth:t,fontSizeIcon:a,calc:l}=e,r=e.fontSizeSM;return(0,Y.mergeToken)(e,{tagFontSize:r,tagLineHeight:(0,G.unit)(l(e.lineHeightSM).mul(r).equal()),tagIconSize:l(a).sub(l(t).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg});},et=e=>({defaultBg:new V.FastColor(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var ea=(0,J.genStyleHooks)("Tag",e=>Z(ee(e)),et),el=this&&this.__rest||function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>t.indexOf(l)&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,l=Object.getOwnPropertySymbols(e);r<l.length;r++)0>t.indexOf(l[r])&&Object.prototype.propertyIsEnumerable.call(e,l[r])&&(a[l[r]]=e[l[r]]);return a;};let er=n.forwardRef((e,t)=>{let{prefixCls:a,style:l,className:r,checked:s,children:o,icon:i,onChange:d,onClick:c}=e,u=el(e,["prefixCls","style","className","checked","children","icon","onChange","onClick"]),{getPrefixCls:h,tag:x}=n.useContext(U.ConfigContext),f=h("tag",a),[g,p,m]=ea(f),j=(0,M.default)(f,`${f}-checkable`,{[`${f}-checkable-checked`]:s},null==x?void 0:x.className,r,p,m);return g(n.createElement("span",Object.assign({},u,{ref:t,style:Object.assign(Object.assign({},l),null==x?void 0:x.style),className:j,onClick:e=>{null==d||d(!s),null==c||c(e);}}),i,n.createElement("span",null,o)));});var es=a("c7544f50");let eo=e=>(0,es.genPresetColor)(e,(t,{textColor:a,lightBorderColor:l,lightColor:r,darkColor:s})=>({[`${e.componentCls}${e.componentCls}-${t}`]:{color:a,background:r,borderColor:l,"&-inverse":{color:e.colorTextLightSolid,background:s,borderColor:s},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}));var en=(0,es.genSubStyleComponent)(["Tag","preset"],e=>eo(ee(e)),et);let ei=(e,t,a)=>{let l="string"!=typeof a?a:a.charAt(0).toUpperCase()+a.slice(1);return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:e[`color${a}`],background:e[`color${l}Bg`],borderColor:e[`color${l}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}};};var ed=(0,J.genSubStyleComponent)(["Tag","status"],e=>{let t=ee(e);return[ei(t,"success","Success"),ei(t,"processing","Info"),ei(t,"error","Error"),ei(t,"warning","Warning")];},et),ec=this&&this.__rest||function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>t.indexOf(l)&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,l=Object.getOwnPropertySymbols(e);r<l.length;r++)0>t.indexOf(l[r])&&Object.prototype.propertyIsEnumerable.call(e,l[r])&&(a[l[r]]=e[l[r]]);return a;};let eu=n.forwardRef((e,t)=>{let{prefixCls:a,className:l,rootClassName:r,style:s,children:o,icon:i,color:d,onClose:c,bordered:u=!0,visible:h}=e,x=ec(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:f,direction:g,tag:p}=n.useContext(U.ConfigContext),[m,j]=n.useState(!0),y=(0,B.default)(x,["closeIcon","closable"]);n.useEffect(()=>{void 0!==h&&j(h);},[h]);let b=(0,D.isPresetColor)(d),v=(0,D.isPresetStatusColor)(d),S=b||v,C=Object.assign(Object.assign({backgroundColor:d&&!S?d:void 0},null==p?void 0:p.style),s),k=f("tag",a),[P,F,E]=ea(k),R=(0,M.default)(k,null==p?void 0:p.className,{[`${k}-${d}`]:S,[`${k}-has-color`]:d&&!S,[`${k}-hidden`]:!m,[`${k}-rtl`]:"rtl"===g,[`${k}-borderless`]:!u},l,r,F,E),Q=e=>{e.stopPropagation(),null==c||c(e),e.defaultPrevented||j(!1);},[,w]=(0,A.useClosable)((0,A.pickClosable)(e),(0,A.pickClosable)(p),{closable:!1,closeIconRender:e=>{let t=n.createElement("span",{className:`${k}-close-icon`,onClick:Q},e);return(0,z.replaceElement)(e,t,e=>({onClick:t=>{var a;null===(a=null==e?void 0:e.onClick)||void 0===a||a.call(e,t),Q(t);},className:(0,M.default)(null==e?void 0:e.className,`${k}-close-icon`)}));}}),$="function"==typeof x.onClick||o&&"a"===o.type,T=i||null,N=T?n.createElement(n.Fragment,null,T,o&&n.createElement("span",null,o)):o,H=n.createElement("span",Object.assign({},y,{ref:t,className:R,style:C}),N,w,b&&n.createElement(en,{key:"preset",prefixCls:k}),v&&n.createElement(ed,{key:"status",prefixCls:k}));return P($?n.createElement(K.default,{component:"Tag"},H):H);});eu.CheckableTag=er;let eh=({data:e,loading:t,type:a,onServiceDetail:l})=>{let r=[{title:"\u670D\u52A1\u540D\u79F0",dataIndex:"serviceName",key:"serviceName"},{title:"\u8DEF\u5F84",dataIndex:"path",key:"path"},{title:"\u65B9\u6CD5",dataIndex:"method",key:"method",render:e=>(0,s.jsx)(eu,{color:"GET"===e?"green":"POST"===e?"blue":"PUT"===e?"orange":"red",children:e})},{title:"\u5F53\u524DQPS",dataIndex:"currentQPS",key:"currentQPS",sorter:(e,t)=>e.currentQPS-t.currentQPS},{title:"\u5E73\u5747QPS",dataIndex:"avgQPS",key:"avgQPS",sorter:(e,t)=>e.avgQPS-t.avgQPS},{title:"\u6700\u5927QPS",dataIndex:"maxQPS",key:"maxQPS",sorter:(e,t)=>e.maxQPS-t.maxQPS},{title:"\u603B\u8BF7\u6C42\u6570",dataIndex:"totalRequests",key:"totalRequests",sorter:(e,t)=>e.totalRequests-t.totalRequests},{title:"\u9519\u8BEF\u6570",dataIndex:"totalErrors",key:"totalErrors",sorter:(e,t)=>e.totalErrors-t.totalErrors},{title:"\u9519\u8BEF\u7387",dataIndex:"errorRate",key:"errorRate",render:e=>`${e.toFixed(2)}%`,sorter:(e,t)=>e.errorRate-t.errorRate},{title:"\u7F13\u5B58\u547D\u4E2D\u7387",dataIndex:"cacheHitRate",key:"cacheHitRate",render:e=>`${e.toFixed(2)}%`,sorter:(e,t)=>e.cacheHitRate-t.cacheHitRate},{title:"\u64CD\u4F5C",key:"action",fixed:"right",render:(e,t)=>(0,s.jsx)(g.default,{type:"link",onClick:()=>l&&l(t.serviceName),children:"\u8BE6\u7EC6\u4FE1\u606F"})}];return Array.isArray(e)&&"router"===a&&e.map(e=>({...e,key:`${e.serviceName}-${e.path}-${e.method}`})),(0,s.jsx)(q.default,{columns:r,dataSource:e,loading:t,rowKey:"key",pagination:{pageSize:10},scroll:{x:1300}});};var ex=a("95f2367f"),ef=a("2d9af956"),eg=l._(ef),ep=a("7bd8b35e"),em=l._(ep),ej=a("69db35bc"),ey=l._(ej),eb=a("caca162f"),ev=l._(eb),eS=a("b2b30127"),eC=l._(eS),ek=a("79e0af3c"),eP=l._(ek),eF=a("56296091"),eE=l._(eF),eR=a("278430cb"),eQ=a("752ff3ec"),ew=l._(eQ);let e$={xs:24,sm:12,md:12,lg:12,xl:4,style:{marginBottom:24}},eT=({loading:e,visitData:t,overallStats:a})=>{let{styles:l}=(0,eE.default)();return(0,s.jsxs)(ev.default,{gutter:24,children:[(0,s.jsx)(em.default,{titlePlacement:"start",style:{margin:"16px"},children:"\u670D\u52A1\u7EDF\u8BA1"}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsxs)(eR.ChartCard,{bordered:!1,title:"\u670D\u52A1\u603B\u6570",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),loading:e,total:()=>a.totalServices,footer:(0,s.jsx)(eR.Field,{label:"\u8FD0\u884C\u72B6\u6001",value:`\u{6B63}\u{5E38}`}),contentHeight:46,children:[(0,s.jsxs)(ew.default,{flag:"up",style:{marginRight:16},children:["\u5468\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"12%"})]}),(0,s.jsxs)(ew.default,{flag:"down",children:["\u65E5\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"11%"})]})]})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsx)(eR.ChartCard,{bordered:!1,loading:e,title:"\u603B\u8BF7\u6C42\u6570",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:(0,eP.default)(a.totalRequests).format("0,0"),footer:(0,s.jsx)(eR.Field,{label:"\u65E5\u8BBF\u95EE\u91CF",value:(0,eP.default)(1234).format("0,0")}),contentHeight:46,children:(0,s.jsx)(ex.Area,{xField:"x",yField:"y",shapeField:"smooth",height:46,axis:!1,style:{fill:"linear-gradient(-90deg, white 0%, #975FE4 100%)",fillOpacity:.6,width:"100%"},padding:-20,data:t})})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsx)(eR.ChartCard,{bordered:!1,loading:e,title:"\u6700\u5927QPS",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:(0,eP.default)(8560).format("0,0"),footer:(0,s.jsx)(eR.Field,{label:"\u65E5\u540C\u6BD4",value:"0.34%"}),contentHeight:46,children:(0,s.jsx)(ex.Column,{xField:"x",yField:"y",padding:-20,axis:!1,height:46,data:t,scale:{x:{paddingInner:.4}}})})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsx)(eR.ChartCard,{bordered:!1,loading:e,title:"\u5E73\u5747QPS",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:(0,eP.default)(a.avgQPS.toFixed(2)).format("0,0"),footer:(0,s.jsx)(eR.Field,{label:"\u65E5\u540C\u6BD4",value:"0.34%"}),contentHeight:46,children:(0,s.jsx)(ex.Column,{xField:"x",yField:"y",padding:-20,axis:!1,height:46,data:t,scale:{x:{paddingInner:.4}}})})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsx)(eR.ChartCard,{loading:e,bordered:!1,title:"\u603B\u9519\u8BEF\u6570",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:a.totalErrors,footer:(0,s.jsxs)("div",{style:{whiteSpace:"nowrap",overflow:"hidden"},children:[(0,s.jsxs)(ew.default,{flag:"up",style:{marginRight:16},children:["\u5468\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"12%"})]}),(0,s.jsxs)(ew.default,{flag:"down",children:["\u65E5\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"11%"})]})]}),contentHeight:46,children:(0,s.jsx)(ey.default,{percent:2,strokeColor:{from:"#108ee9",to:"#87d068"},status:"active"})})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsx)(eR.ChartCard,{loading:e,bordered:!1,title:"\u7F13\u5B58\u547D\u4E2D\u7387",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:a.cacheHitRate.toFixed(2),footer:(0,s.jsxs)("div",{style:{whiteSpace:"nowrap",overflow:"hidden"},children:[(0,s.jsxs)(ew.default,{flag:"up",style:{marginRight:16},children:["\u5468\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"12%"})]}),(0,s.jsxs)(ew.default,{flag:"down",children:["\u65E5\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"11%"})]})]}),contentHeight:46,children:(0,s.jsx)(ey.default,{percent:a.cacheHitRate.toFixed(2),strokeColor:{from:"#108ee9",to:"#87d068"},status:"active"})})}),(0,s.jsx)(em.default,{titlePlacement:"start",style:{margin:"16px"},children:"WebSocket \u7EDF\u8BA1"}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsxs)(eR.ChartCard,{bordered:!1,title:"\u603B\u94FE\u63A5\u6570",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),loading:e,total:()=>a.totalWSConnections,footer:(0,s.jsx)(eR.Field,{label:"\u8FD0\u884C\u72B6\u6001",value:""}),contentHeight:46,children:[(0,s.jsxs)(ew.default,{flag:"up",style:{marginRight:16},children:["\u5468\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"12%"})]}),(0,s.jsxs)(ew.default,{flag:"down",children:["\u65E5\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"11%"})]})]})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsx)(eR.ChartCard,{bordered:!1,loading:e,title:"\u603B\u6D88\u606F\u6570",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:(0,eP.default)(a.totalWSMessages).format("0,0"),footer:(0,s.jsx)(eR.Field,{label:"\u65E5\u8BBF\u95EE\u91CF",value:(0,eP.default)(1234).format("0,0")}),contentHeight:46,children:(0,s.jsx)(ex.Area,{xField:"x",yField:"y",shapeField:"smooth",height:46,axis:!1,style:{fill:"linear-gradient(-90deg, white 0%, #975FE4 100%)",fillOpacity:.6,width:"100%"},padding:-20,data:t})})}),(0,s.jsx)(eg.default,{...e$,children:(0,s.jsxs)(eR.ChartCard,{bordered:!1,loading:e,title:"\u603B\u9519\u8BEF\u6570",action:(0,s.jsx)(eC.default,{title:"\u6307\u6807\u8BF4\u660E",children:(0,s.jsx)(Q.default,{})}),total:(0,eP.default)(a.totalWSErrors).format("0,0"),footer:(0,s.jsx)(eR.Field,{label:"\u65E5\u540C\u6BD4",value:"0.34%"}),contentHeight:46,children:[(0,s.jsxs)(ew.default,{flag:"up",style:{marginRight:16},children:["\u5468\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"12%"})]}),(0,s.jsxs)(ew.default,{flag:"down",children:["\u65E5\u540C\u6BD4",(0,s.jsx)("span",{className:l.trendText,children:"11%"})]})]})})]});};var eN=a("1711f983"),eH=a("215810bf"),e_=a("fb726300"),eO=a("ce0780be"),eq=l._(eO),eI=a("8a193048"),eM=l._(eI);let{RangePicker:eW}=eq.default,eB=[];for(let e=0;e<7;e+=1)eB.push({title:`Market ${e} `,total:323234});let eD=({data:e,currentTabKey:t})=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ev.default,{gutter:8,style:{width:138},children:(0,s.jsx)(eg.default,{span:24,children:(0,s.jsx)(eM.default,{style:{},title:e.serviceName,subTitle:(e.avgQPS/(e.maxQPS?e.maxQPS:1)*100).toFixed(2)+"%",gap:2,total:`${100*e.cvr}%`,theme:t!==e.serviceName?"light":void 0})})}),(0,s.jsx)(ev.default,{gutter:8,style:{width:138},children:(0,s.jsx)(eg.default,{span:24,style:{},children:e.avgQPS?(0,s.jsx)(e_.Tiny.Ring,{height:60,width:60,percent:e.avgQPS/(e.maxQPS?e.maxQPS:1),color:["#E8EEF4","#5FABF4"]}):(0,s.jsx)(e_.Tiny.Ring,{height:60,width:60,percent:1,color:["#E8EEF4"]})})})]}),eA=({rangePickerValue:e,salesData:t,isActive:a,handleRangePickerChange:l,loading:r,selectDate:o})=>{let{styles:n}=(0,eE.default)();return console.log({salesData:t}),(0,s.jsx)(d.default,{loading:r,variant:"borderless",styles:{body:{padding:r?24:0}},children:(0,s.jsx)(y.default,{className:n.salesCard,tabBarExtraContent:(0,s.jsxs)("div",{className:n.salesExtraWrap,children:[(0,s.jsxs)("div",{className:n.salesExtra,children:[(0,s.jsx)(g.default,{type:"text",className:a("today"),onClick:()=>o("today"),children:"\u4ECA\u65E5"}),(0,s.jsx)(g.default,{type:"text",className:a("week"),onClick:()=>o("week"),children:"\u672C\u5468"}),(0,s.jsx)(g.default,{type:"text",className:a("month"),onClick:()=>o("month"),children:"\u672C\u6708"}),(0,s.jsx)(g.default,{type:"text",className:a("year"),onClick:()=>o("year"),children:"\u672C\u5E74"})]}),(0,s.jsx)(eW,{value:e,onChange:l,variant:"filled",style:{width:256}})]}),size:"large",tabBarStyle:{marginBottom:24},items:[{key:"sales",label:"QPS\u8D8B\u52BF",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ev.default,{children:(0,s.jsx)(eg.default,{xl:24,lg:24,md:24,sm:24,xs:24,children:(0,s.jsx)("div",{className:n.salesBar,children:(0,s.jsx)(ex.Line,{height:300,data:t,xField:"index",yField:"qps",colorField:"name",seriesField:"name",paddingBottom:12,axis:{x:{title:!1},y:{title:!1,labelFill:"#fff",gridLineDash:null,gridStroke:"#fff"}},legend:{color:{itemLabelFill:"#fff"}},scale:{x:{paddingInner:.4}},tooltip:{name:"\u4EA4\u6613\u989D",channel:"y"}})})})})})}]})});};var ez=a("d87e5ab1");let{Title:eL,Text:eK}=x.default,eU=e=>e.replace(/_([a-z])/g,(e,t)=>t.toUpperCase()).replace(/Qps\b/g,"QPS").replace(/Ws\b/g,"WS"),eG=e=>Array.isArray(e)?e.map(eG):e&&"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,t])=>[eU(e),eG(t)])):e,eV=()=>{let[e,t]=(0,n.useState)(!0),[a,l]=(0,n.useState)(null),[r,o]=(0,n.useState)([]),{data:i}=(0,eN.useRequest)(eH.fakeChartData),[c,h]=(0,n.useState)(!0);async function x(){let e=await (0,ez.getService)(),t=await Promise.all(e.map(e=>(0,ez.getServiceStats)(e.Name))),a=t.filter(e=>null==e?void 0:e.data).map(e=>eG(e.data)).flat();return console.log(a),o(a),t;}if((0,n.useEffect)(()=>{c?x():o(_),t(!1);},[c]),a){console.log({service:a});let t=(e=>{if(!e)return null;let{totalRequests:t,totalCacheHits:a,totalCacheMisses:l,totalRouters:r,maxQPS:s,avgQPS:o,totalErrors:n,totalWSConnections:i,totalWSMessages:d,totalWSErrors:c}=e;return{totalServices:r,totalRequests:t,maxQPS:s,avgQPS:o,totalErrors:n,cacheHitRate:l+a>0?a/(l+a)*100:0,totalWSConnections:i,totalWSMessages:d,totalWSErrors:c};})(a),r=a.routers.flatMap(e=>(e.qpsHistory??[]).map((t,a)=>({name:e.path,index:a,qps:t})));return(0,s.jsx)("div",{children:(0,s.jsxs)(u.default,{orientation:"vertical",size:"large",style:{width:"100%"},children:[(0,s.jsx)(d.default,{children:(0,s.jsxs)(u.default,{align:"center",style:{width:"100%",justifyContent:"space-between"},children:[(0,s.jsxs)(u.default,{children:[(0,s.jsx)(g.default,{icon:(0,s.jsx)(E.default,{}),onClick:()=>{l(null);},children:"\u8FD4\u56DE\u603B\u89C8"}),(0,s.jsxs)(eL,{level:4,style:{margin:0},children:[a.serviceName," \u8BE6\u7EC6\u76D1\u63A7"]})]}),(0,s.jsxs)(eK,{type:"secondary",children:["\u66F4\u65B0\u65F6\u95F4: ",new Date(a.collectedAt).toLocaleString()]})]})}),t&&(0,s.jsx)(eT,{loading:e,overallStats:t,visitData:(null==i?void 0:i.visitData)||[]}),(0,s.jsx)(d.default,{children:(0,s.jsx)(y.default,{activeKey:"sad",items:a.routers.map(e=>({key:e.path,label:(0,s.jsx)(eD,{data:{...e,serviceName:e.path},currentTabKey:""})}))})}),(0,s.jsx)(eA,{loading:e,salesData:r,rangePickerValue:null,isActive:()=>"",handleRangePickerChange:()=>{},selectDate:()=>{}}),(0,s.jsxs)(d.default,{children:[(0,s.jsxs)(eL,{level:5,style:{marginTop:0},children:[(0,s.jsx)(P.default,{})," \u8DEF\u7531\u8BE6\u60C5"]}),(0,s.jsx)(eh,{data:a.routers.map(e=>{var t,a;return{...e,maxQPS:parseFloat(null===(t=e.maxQPS)||void 0===t?void 0:t.toFixed(2)),avgQPS:parseFloat(null===(a=e.avgQPS)||void 0===a?void 0:a.toFixed(2))};}),loading:e,type:"router"})]})]})});}let f=0===r.length?null:{totalServices:r.length,totalRequests:r.reduce((e,t)=>e+t.totalRequests,0),maxQPS:Math.max(...r.map(e=>e.totalQPS)),avgQPS:r.reduce((e,t)=>e+t.avgQPS,0)/r.length,totalErrors:r.reduce((e,t)=>e+t.totalErrors,0),cacheHitRate:r.reduce((e,t)=>t.totalCacheHits+t.totalCacheMisses>0?t.totalCacheHits/(t.totalCacheHits+t.totalCacheMisses)*100:0,0)/r.length,totalWSConnections:r.reduce((e,t)=>e+t.totalWSConnections,0),totalWSMessages:r.reduce((e,t)=>e+t.totalWSMessages,0),totalWSErrors:r.reduce((e,t)=>e+t.totalWSErrors,0)},p=(()=>{if(0===r.length)return[];let e=[];return r.forEach(t=>{t.routers.length>0&&t.routers[0].qpsHistory&&t.routers[0].qpsHistory.forEach((a,l)=>{e.push({name:t.serviceName,qps:a,index:l,type:"\u5F53\u524DQPS"});}),e.push({name:t.serviceName,qps:t.maxQPS,index:t.routers.length>0&&t.routers[0].qpsHistory?t.routers[0].qpsHistory.length:0,type:"\u6700\u5927QPS"});}),e;})(),j=r.map(e=>{var t,a;return{key:e.serviceName,serviceName:e.serviceName,totalRouters:e.totalRouters,totalRequests:e.totalRequests,totalQPS:e.totalQPS,avgQPS:parseFloat(null===(t=e.avgQPS)||void 0===t?void 0:t.toFixed(2)),maxQPS:parseFloat(null===(a=e.maxQPS)||void 0===a?void 0:a.toFixed(2)),totalErrors:e.totalErrors,errorRate:e.totalRequests>0?parseFloat((e.totalErrors/e.totalRequests*100).toFixed(2)):0,cacheHitRate:e.totalCacheHits>0?parseFloat((e.totalCacheHits/(e.totalCacheHits+e.totalCacheMisses)*100).toFixed(2)):0,totalWSConnections:e.totalWSConnections,totalWSMessages:e.totalWSMessages,totalWSErrors:e.totalWSErrors};});return(0,s.jsx)(m.default,{spinning:e,children:(0,s.jsxs)(u.default,{orientation:"vertical",size:"large",style:{width:"100%"},children:[(0,s.jsx)(d.default,{children:(0,s.jsxs)(v.default,{justify:"space-between",align:"center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(eL,{level:4,style:{margin:0},children:[(0,s.jsx)(C.default,{})," \u7CFB\u7EDF\u76D1\u63A7\u603B\u89C8"]}),(0,s.jsx)(eK,{type:"secondary",children:"\u5B9E\u65F6\u76D1\u63A7\u7CFB\u7EDF\u5404\u670D\u52A1\u8FD0\u884C\u72B6\u6001"})]}),(0,s.jsx)(g.default,{type:"text",icon:(0,s.jsx)(Q.default,{}),onClick:()=>h(!c)})]})}),f&&(0,s.jsx)(eT,{loading:e,overallStats:f,visitData:(null==i?void 0:i.visitData)||[]}),(0,s.jsx)(d.default,{children:(0,s.jsx)(y.default,{activeKey:"sad",items:r.map(e=>({key:e.serviceName,label:(0,s.jsx)(eD,{data:e,currentTabKey:""})}))})}),(0,s.jsx)(eA,{loading:e,salesData:p,rangePickerValue:null,isActive:()=>"",handleRangePickerChange:()=>{},selectDate:()=>{}}),(0,s.jsxs)(d.default,{children:[(0,s.jsxs)(eL,{level:5,style:{marginTop:0},children:[(0,s.jsx)(P.default,{})," \u670D\u52A1\u8BE6\u60C5"]}),(0,s.jsx)(eh,{data:j,loading:e,type:"service",onServiceDetail:e=>{let t=r.find(t=>t.serviceName===e);t&&l(t);}})]})]})});};}}]);
//# sourceMappingURL=2856cd5d-async.407dc9e3.js.map