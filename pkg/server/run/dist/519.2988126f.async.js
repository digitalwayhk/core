(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[519],{66721:function(Zt,Sn,a){"use strict";a.d(Sn,{Z:function(){return Ct}});var jt=a(13062),se=a(71230),Et=a(89032),re=a(15746),bt=a(71194),ke=a(48889),wt=a(34792),nn=a(48086),w=a(2824),s=a(67294),xn=a(28216),Ft=a(58024),Me=a(39144),Dt=a(48736),tn=a(27049),Tt=a(49111),Ke=a(19650),Rt=a(30887),an=a(54689),_=a(11849),yn=a(69610),Cn=a(54941),Zn=a(57254),jn=a(7945),En=a(24616),bn=a(63270),wn=a(3050),Fn=a(16165),Dn=a(49101),Tn=a(73171),Rn=a(8212),Mn=a(65233),Bn=a(20924),In=a(25592),Mt=a(59250),On=a(13013),Bt=a(22385),ln=a(94199),It=a(57663),we=a(71577),An=a(57119),n=a(85893),Vn=function(e){var f,x,u,o,j,R,z,I,v,M,O,E={key:(f=e.key)!==null&&f!==void 0?f:e.name,name:(x=e.name)!==null&&x!==void 0?x:"",title:(u=e.title)!==null&&u!==void 0?u:"",text:e.text,danger:(o=e.danger)!==null&&o!==void 0?o:!1,block:(j=e.block)!==null&&j!==void 0?j:!1,type:(R=e.type)!==null&&R!==void 0?R:"default",target:e.target,size:(z=e.size)!==null&&z!==void 0?z:"default",shape:(I=e.shape)!==null&&I!==void 0?I:"",icon:(v=e.icon)!==null&&v!==void 0?v:"",ghost:(M=e.ghost)!==null&&M!==void 0?M:!1,disabled:(O=e.disabled)!==null&&O!==void 0?O:!1},N=(0,s.useState)(!1),q=(0,w.Z)(N,2),r=q[0],t=q[1];function g(){return e.toolbar!=null&&e.name!=null&&e.toolbar.attrs!=null&&e.toolbar.attrs.length>0?e.toolbar.attrs.find(function(P){return P.command==e.name}):null}var A=function(){if(e.onClick!=null)try{t({delay:100});var ie=g();ie!=null&&ie.isalert?ke.Z.confirm({title:"\u60A8\u786E\u8BA4\u8981\u8FDB\u884C".concat(E.text,"\u5417?"),icon:(0,n.jsx)(An.Z,{}),onOk:function(){e.onClick(E)}}):e.onClick(E)}finally{t(!1)}};function l(){return e.ismenu?(0,n.jsx)(On.Z,{overlay:e.menu,children:(0,n.jsx)(ln.Z,{title:E.title,children:(0,n.jsx)(we.Z,(0,_.Z)((0,_.Z)({},E),{},{onClick:A,loading:r,children:E.text}))})}):(0,n.jsx)(ln.Z,{title:E.title,children:(0,n.jsx)(we.Z,(0,_.Z)((0,_.Z)({},E),{},{onClick:A,loading:r,children:E.text}))})}return l()},Be=Vn,Ot=a(47673),Je=a(4107),At=a(36877),kn=a(96607),Vt=a(77883),Ln=a(70507),kt=a(77576),Wn=a(12028),Lt=a(43358),Pn=a(34041),Wt=a(53400),un=a(41505),zn=a(76010),Le=a(96486),Oe=a(86582),Pt=a(8963),Nn=a(68297),zt=a(18106),He=a(58634),Kn=a(30381),on=a.n(Kn),We=a(75308);function rn(J,e,f){var x,u,o=(0,We.MM)(e,J);if((x=e.comvtp)!==null&&x!==void 0&&x.isvtp){var j=new Map(e.comvtp.items);o=j.get(o)}if((u=e.foreign)!==null&&u!==void 0&&u.isfkey){var R=e.foreign.oneobjectfield,z=e.foreign.onedisplayname;f[R]!=null&&(o=f[R][z])}if(e.type=="boolean"&&(o=o?"\u662F":"\u5426"),e.type=="datetime"){var I;o=o!=""?on()(o).format((I=e.datatimetype)===null||I===void 0?void 0:I.dateformat).toString():""}return o}var Hn=function(e,f,x,u){var o,j=e.attr,R=[];function z(v,M,O){var E=rn(v,M,O);return e.onFieldRender!=null?e.onFieldRender(M,E,O):(0,n.jsx)(n.Fragment,{children:E})}var I=function(M,O){return e.onColumnToEdit?e.onColumnToEdit(M,O):(e.onGetFieldToEdit&&(M=e.onGetFieldToEdit(M,O)),u(O),(0,n.jsx)(Ye,{attr:M,value:x[M.field],onChange:function(N){if(!(e.onRowDataChangeing!=null&&!e.onRowDataChangeing(O,M.field,N))){console.log(N);var q=Object.assign({},x);O[M.field]=N,q[M.field]=N,u(q)}},onSearchValueChange:function(N){e.onSearchValueChange&&e.onSearchValueChange(M,O,N)},onSearchBefore:function(N,q){e.onSearchData&&e.onSearchData(N,function(r){q(r.model,r)})},onSearchData:e.onSearchData}))};return j==null||(o=j.fields)===null||o===void 0||o.filter(function(v){return v.visible}).forEach(function(v){var M;R.push({dataIndex:v.field,title:v.title,sorter:(M=v.sorter)!==null&&M!==void 0?M:!0,render:function(E,N){if(N!=null)return f&&N.editable&&(v.isedit==null||v.isedit==!0)?I(v,N):z(E,v,N)}})}),R},Gn=He.Z.TabPane,Jn=function J(e){var f,x,u,o,j,R=(0,s.useState)((f=e.loading)!==null&&f!==void 0?f:!1),z=(0,w.Z)(R,2),I=z[0],v=z[1],M=(0,s.useState)((x=e.data)!==null&&x!==void 0?x:{rows:[],total:0}),O=(0,w.Z)(M,2),E=O[0],N=O[1],q=(0,s.useState)((u=e.rowedit)!==null&&u!==void 0?u:!1),r=(0,w.Z)(q,2),t=r[0],g=r[1],A=(0,s.useState)((o=e.current)!==null&&o!==void 0?o:1),l=(0,w.Z)(A,2),P=l[0],ie=l[1],G=(0,s.useState)(10),ce=(0,w.Z)(G,2),de=ce[0],ve=ce[1],V=(0,s.useState)([]),h=(0,w.Z)(V,2),F=h[0],Z=h[1],te=(0,s.useState)((j=e.selectType)!==null&&j!==void 0?j:"radio"),U=(0,w.Z)(te,2),oe=U[0],he=U[1],Ze=(0,s.useState)(),ge=(0,w.Z)(Ze,2),ye=ge[0],me=ge[1],X=(0,s.useState)({}),m=(0,w.Z)(X,2),y=m[0],i=m[1];(0,s.useEffect)(function(){var d;N((d=e.data)!==null&&d!==void 0?d:{rows:[],total:0})},[e.data]),(0,s.useEffect)(function(){var d;g((d=e.rowedit)!==null&&d!==void 0?d:!1)},[e.rowedit]),(0,s.useEffect)(function(){var d;v((d=e.loading)!==null&&d!==void 0?d:!1)},[e.loading]),(0,s.useEffect)(function(){var d;ie((d=e.current)!==null&&d!==void 0?d:1)},[e.current]);var S=function(b,k,T){var ae,ue,je=function(B){v(!1),N(B)},De=function(B){if(B.column==null)return"";var p={name:B.field,isdesc:!1};return B.order=="descend"&&(p.isdesc=!0),p};v(!0),ie((ae=b.current)!==null&&ae!==void 0?ae:1),ve((ue=b.pageSize)!==null&&ue!==void 0?ue:10);try{var D,c,C={page:(D=b.current)!==null&&D!==void 0?D:1,size:(c=b.pageSize)!==null&&c!==void 0?c:10,sortList:[]};if(T!=null)if((0,Le.isArray)(T))T.forEach(function(H){var B=De(H);B!=""&&H.sortList.push(B)});else{var L=De(T);L!=""&&C.sortList.push(L)}e.onSearchData!=null&&e.onSearchData(C,je)}finally{v(!1)}},K=function(b,k){var T=F.length<=b.length;if(Z(b),e.onSelectRows!=null)if(b.length>0){var ae=k[k.length-1];T||(ae=null,b.length==1&&(ae=E.rows.find(function(ue){return ue.id==b[0]}))),e.onSelectRows(ae,b,T)}else e.onSelectRows(null,b,!1)},Q=function(){if(!!e.isselect)return{selectedRowKeys:F,fixed:!0,type:oe,columnTitle:ye,hideSelectAll:!1,columnWidth:"32px",onChange:K}};function ee(d){d=="checkbox"&&(he("radio"),Z([]),e.onSelectStateChange&&e.onSelectStateChange(!1),me(ne()))}function ne(){return(0,n.jsx)(we.Z,{type:"link",onClick:function(){me(null),he("checkbox"),Z([]),e.onSelectStateChange&&e.onSelectStateChange(!0)},children:"\u591A\u9009"})}function Ee(d){if(e.isedit){d.editable=!t;var b=(0,Oe.Z)(E.rows);b.forEach(function(k){k.id==d.id?k.editable=!t:k.editable&&(k.editable=!1)}),g(!t)}}function Fe(){var d;if(e.isexpandable&&(e==null||(d=e.attr)===null||d===void 0?void 0:d.childmodels)!=null&&e.attr.childmodels.length>0)return e.onExpandable==null?{onExpand:function(k,T){var ae;if(!!k&&(e==null||(ae=e.attr)===null||ae===void 0?void 0:ae.childmodels)!=null&&e.attr.childmodels.length>0){var ue,je=e==null||(ue=e.attr)===null||ue===void 0?void 0:ue.childmodels[0];if(T[je.propertyname]||(T[je.propertyname]=[]),T[je.propertyname].total=T[je.propertyname].length,T[je.propertyname].total==0){var De={page:1,size:10};be(De,je,T)}}},expandedRowRender:ze}:e.onExpandable(e.attr)}function be(d,b,k){d.childmodel=b,d.parent=k,e.onSearchData!=null&&e.onSearchData(d,function(T){var ae=(0,Oe.Z)(E.rows);ae.forEach(function(ue){ue.id==k.id&&(ue[b.propertyname]=T.rows,ue[b.propertyname].total=T.total)}),N({rows:ae,total:E.total})})}var Pe=function(b,k){if(e.onExpandedRowTabPane){var T=e.onExpandedRowTabPane(b,k);if(T!=null)return T}return(0,n.jsx)(J,{isselect:!1,isedit:!1,isclosecard:!0,attr:b,data:{rows:k[b.propertyname],total:k[b.propertyname].total},onSearchData:function(ue){be(ue,b,k)}},"id")},ze=function(b){var k;if((e==null||(k=e.attr)===null||k===void 0?void 0:k.childmodels)!=null&&e.attr.childmodels.length>0)return(0,n.jsx)(He.Z,{defaultActiveKey:"0",onChange:function(ae){var ue=e.attr.childmodels[Number(ae)];be({},ue,b)},children:e.attr.childmodels.map(function(T,ae){return b[T.propertyname]||(b[T.propertyname]=[]),b[T.propertyname].total=b[T.propertyname].length,(0,n.jsx)(Gn,{tab:T.title,children:Pe(T,b)},ae)})})};function le(){var d=Hn(e,t,y,i),b="id";return(0,n.jsx)(Nn.Z,{bordered:!0,rowKey:b,columns:d,rowSelection:Q(),scroll:{x:d.length*150},dataSource:E.rows,pagination:{current:P,pageSize:de,total:E.total,hideOnSinglePage:!0,showTotal:function(T){return"\u603B ".concat(T," \u884C")}},loading:I,expandable:Fe(),onChange:S,onRow:function(T){return{onClick:function(ue){ue.stopPropagation();try{var je,De;if(((je=Q())===null||je===void 0?void 0:je.type)=="radio"&&K([T[b]],[T]),((De=Q())===null||De===void 0?void 0:De.type)=="checkbox"){var D=T[b],c=[];F.includes(D)?c=F.filter(function(C){return C!=D}):(c=(0,Oe.Z)(F),c.push(D)),K(c,[T])}}finally{e.onRowClick&&e.onRowClick(ue,T)}},onDoubleClick:function(ue){ue.stopPropagation(),Ee(T),e.onRowDoubleClick&&e.onRowDoubleClick(ue,T)},onMouseEnter:function(ue){e.onRowMouseEnter&&e.onRowMouseEnter(ue,T)},onMouseLeave:function(ue){e.onMouseLeave&&e.onMouseLeave(ue,T)}}}})}function Y(){return e.isclosecard?le():(0,n.jsx)(Me.Z,{children:le()})}return Y()},Ue=Jn,Un=a(61193),Qn=a.n(Un),Xn=function(e){var f=(0,s.useState)({left:0,top:0,bottom:0,right:0}),x=(0,w.Z)(f,2),u=x[0],o=x[1],j=(0,s.useState)(!0),R=(0,w.Z)(j,2),z=R[0],I=R[1],v=s.createRef(),M=function(q,r){var t,g,A,l=(t=window)===null||t===void 0||(g=t.document)===null||g===void 0?void 0:g.documentElement,P=l.clientWidth,ie=l.clientHeight,G=v==null||(A=v.current)===null||A===void 0?void 0:A.getBoundingClientRect();o({left:-(G==null?void 0:G.left)+(r==null?void 0:r.x),right:P-((G==null?void 0:G.right)-(r==null?void 0:r.x)),top:-(G==null?void 0:G.top)+(r==null?void 0:r.y),bottom:ie-((G==null?void 0:G.bottom)-(r==null?void 0:r.y))})};function O(){return(0,n.jsx)("div",{style:{width:"100%",cursor:"move"},onMouseOver:function(){z&&I(!1)},onMouseOut:function(){I(!0)},onFocus:function(){},onBlur:function(){},children:e.title})}function E(){return(0,n.jsx)(ke.Z,(0,_.Z)((0,_.Z)({},e),{},{title:O(),modalRender:function(q){return(0,n.jsx)(Qn(),{disabled:z,bounds:u,onStart:function(t,g){return M(t,g)},children:(0,n.jsx)("div",{ref:v,children:q})})}}))}return E()},Qe=Xn,Yn=function(e){var f,x,u=(0,s.useState)([]),o=(0,w.Z)(u,2),j=o[0],R=o[1],z=(0,s.useState)(null),I=(0,w.Z)(z,2),v=I[0],M=I[1],O=(0,s.useState)(!1),E=(0,w.Z)(O,2),N=E[0],q=E[1],r=(0,s.useState)(e.data),t=(0,w.Z)(r,2),g=t[0],A=t[1],l=(0,s.useState)(oe()),P=(0,w.Z)(l,1),ie=P[0],G=(0,s.useState)((f=e.commandShow)!==null&&f!==void 0?f:!0),ce=(0,w.Z)(G,1),de=ce[0],ve=(0,s.useState)((x=e.modelshow)!==null&&x!==void 0?x:!1),V=(0,w.Z)(ve,2),h=V[0],F=V[1];(0,s.useEffect)(function(){A(e.data)},[e.data]),(0,s.useEffect)(function(){var X;F((X=e.modelshow)!==null&&X!==void 0?X:!1)},[e.modelshow]);var Z={page:1,size:10,whereList:[],sortList:[]},te=function(){var m,y,i=on()().valueOf(),S={id:i,isnew:!0,editable:!0};if((m=e.model)===null||m===void 0||(y=m.fields)===null||y===void 0||y.forEach(function(ne){ne.field!=null&&ne.field!="id"&&(S[ne.field]=null)}),!(e.onAddRowing!=null&&!e.onAddRowing(S))){var K=[],Q=1;g!=null&&g.rows!=null&&(K=(0,Oe.Z)(g.rows),K.forEach(function(ne){ne.editable=!1}),Q=g.total+Q);var ee=[S].concat((0,Oe.Z)(K));q(!0),e.onAdded!=null&&e.onAdded(S),e.onDataChange!=null?e.onDataChange({rows:ee,total:Q},S,"add"):A({rows:ee,total:Q})}},U=function(){if(j.length>0){var m=[],y=[],i=(0,Oe.Z)(g.rows);j.forEach(function(K){if(K!=null){var Q=i.findIndex(function(ne){return ne.id==K?e.onRemoveRowing!=null&&!e.onRemoveRowing(ne)?!1:(ne.isnew||m.push(K),!0):!1}),ee=i.splice(Q,1);e.onRemoveed!=null&&e.onRemoveed(ee[0]),y.push(ee[0])}});var S={rows:i,total:g.total-1};e.onDataChange!=null?y.length>0&&e.onDataChange(S,y,"remove"):A(S)}};function oe(){var X=[];return e.model!=null&&(e.model.isadd&&X.push({command:"add",name:"\u65B0\u589E"}),e.model.isremove&&X.push({command:"remove",name:"\u5220\u9664",isselectrow:!0,selectmultiple:!0})),e.onGetCommands!=null&&(X=e.onGetCommands(X)),X}function he(X,m){F(X),e.onModalChange&&e.onModalChange(X,m)}function Ze(){var X;if(!e.closetoolbar)return(0,n.jsx)(sn,{iscircle:e.iscirclebutton,commandShow:de,selectcount:j.length,attrs:ie,isclosecard:!1,onClick:function(y,i){e.onCommandClicking&&e.onCommandClicking(i),y=="add"&&te(),y=="remove"&&U(),e.onCommandClicked&&e.onCommandClicked(i)},searchShow:e.closesearch?!1:{fields:(X=e.model)===null||X===void 0?void 0:X.fields,onSearch:function(y){Z.whereList=[],y!=null&&((0,Le.isArray)(y)?Z.whereList=y:Z.whereList=[y]),Z.page=1,Z.sortList=[],e.onSearchData!=null&&e.onSearchData(Z,function(i){A(i)})},onSearchData:e.onSearchData}})}function ge(){var X,m,y;return(0,n.jsx)(Ue,{attr:e.model,data:g,isedit:!e.closeedit,rowedit:N,selectType:(X=e.selectType)!==null&&X!==void 0?X:"checkbox",isselect:(m=e.isselect)!==null&&m!==void 0?m:!0,isclosecard:(y=e.closecard)!==null&&y!==void 0?y:!0,onSelectRows:function(S,K){R(K),M(S)},onSearchData:function(S,K){if(S.foreign&&S.field){e.onSearchData&&e.onSearchData(S,K);return}Z.page=S.page,Z.size=S.size,Z.sortList=S.sortList,e.onSearchData!=null&&e.onSearchData(Z,function(Q){A(Q)})},onRowDataChangeing:function(S,K,Q){return e.onEditRowing!=null?e.onEditRowing(S,K,Q):(!S.isnew&&e.onDataChange!=null&&e.onDataChange(g,S,"edit"),!0)},onRowDoubleClick:function(S,K){K.editable!=null&&q(K.editable),e.ismodal&&h&&he(!1,K)},onGetFieldToEdit:e.onGetFieldToEdit,onColumnToEdit:e.onColumnToEdit,onSearchValueChange:function(S,K,Q){K.isnew&&(K[Q.rowfield]=Q.row),e.onSearchValueChange&&e.onSearchValueChange(S,K,Q)}})}function ye(){return e.closecard?(0,n.jsxs)(n.Fragment,{children:[Ze(),ge()]}):(0,n.jsxs)(Me.Z,{children:[Ze(),ge()]})}function me(){if(e.ismodal){var X;return(0,n.jsx)(Qe,{title:(X=e.model)===null||X===void 0?void 0:X.title,width:600,visible:h,onCancel:function(){he(!1,null)},onOk:function(){he(!1,v)},children:(0,n.jsx)(n.Fragment,{children:ye()})})}else return ye()}return me()},Xe=Yn,$n=un.Z.RangePicker,qn=Je.Z.Search,Ce;(function(J){J.Input="Input",J.TextArea="Input.TextArea",J.InputNumber="InputNumber",J.Switch="Switch",J.DatePicker="DatePicker",J.RangePicker="RangePicker",J.Search="Input.Search",J.Avatar="Avatar",J.Select="Select"})(Ce||(Ce={}));var dn=function(e){var f,x={maxLength:500,size:"middle",placeholder:"",disabled:(f=e.disabled)!==null&&f!==void 0?f:!1,style:{width:"100%"},texttype:Ce.Input};for(var u in x)e.options!=null&&e.options[u]!=null&&(x[u]=e.options[u]);return e.width!=null&&(x.style.width=e.width),x.texttype=_n(e,x),x},_n=function(e,f){var x=e.textType,u=e.attr;if(u!=null){if((u.type=="int"||u.type=="int32"||u.type=="int64"||u.type=="decimal")&&(x=Ce.InputNumber,f.min=u.min,u.precision!=null&&u.precision>0&&(f.precision=u.precision),f.picker=void 0),u.type=="datetime"&&(x=Ce.DatePicker),u.type=="boolean"&&(x=Ce.Switch,e.search)){x=Ce.Select;var o=[{label:"\u662F",value:!0},{label:"\u5426",value:!1}];f.options=o}if(u.comvtp!=null&&u.comvtp.isvtp){x=Ce.Select;var j=[];(0,Le.isMap)(u.comvtp.items)||(u.comvtp.items=new Map(u.comvtp.items)),u.comvtp.items.forEach(function(R,z){j.push({label:R,value:z})}),f.options=j}u.foreign!=null&&u.foreign.isfkey&&(x=Ce.Search),u.length!=null&&u.length>0&&(f.maxLength=u.length),e.disabled==null&&u.disabled!=null&&(f.disabled=u.disabled),e.search&&(f.disabled=!1)}return x==null&&(x=Ce.Input),x},pn=function(e){var f=(0,s.useState)(function(){return dn(e)}),x=(0,w.Z)(f,2),u=x[0],o=x[1],j=(0,s.useState)({isshow:!1,model:void 0,data:void 0}),R=(0,w.Z)(j,2),z=R[0],I=R[1],v=(0,s.useState)({row:void 0,value:"",text:"",rowfield:""}),M=(0,w.Z)(v,2),O=M[0],E=M[1],N=(0,zn.Z)(e.defaultValue,{value:g(e.value),onChange:function(h,F){if(console.log(h),e.onChange!=null){var Z=A(h);console.log(Z),e.onChange(Z)}}}),q=(0,w.Z)(N,2),r=q[0],t=q[1];(0,s.useEffect)(function(){if(e.search){var V;O.field!=((V=e.attr)===null||V===void 0?void 0:V.field)&&l(null),o(dn(e))}},[e.attr]),(0,s.useEffect)(function(){var V;if(((V=e.attr)===null||V===void 0?void 0:V.foreign)!=null&&e.attr.foreign.isfkey&&e.children!=null&&!e.search&&O.row==null&&e.value!=null){var h=e.children[e.attr.foreign.oneobjectfield];l(h)}},[e.value]);function g(V){var h=e.attr;return(0,We.MM)(h,V)}function A(V){var h=e.attr;switch(u.texttype){case Ce.Select:return(h==null?void 0:h.type)=="string"?V.label:V}return(0,We.Nz)(h,V)}function l(V){var h={value:"",text:"",row:void 0,rowfield:"",field:""};if(V){var F,Z,te,U,oe,he,Ze,ge,ye,me,X=(F=(Z=e.attr)===null||Z===void 0||(te=Z.foreign)===null||te===void 0?void 0:te.oneobjectfieldkey)!==null&&F!==void 0?F:"",m=(U=(oe=e.attr)===null||oe===void 0||(he=oe.foreign)===null||he===void 0?void 0:he.onedisplayname)!==null&&U!==void 0?U:"";console.log(X+"---"+m),h.row=V,h.value=V[X],h.text=V[m],h.rowfield=(Ze=(ge=e.attr)===null||ge===void 0||(ye=ge.foreign)===null||ye===void 0?void 0:ye.oneobjectfield)!==null&&Ze!==void 0?Ze:"",h.field=(me=e.attr)===null||me===void 0?void 0:me.field,console.log(h)}E(h),t(h.value),e.onSearchValueChange&&e.onSearchValueChange(h)}function P(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(qn,(0,_.Z)((0,_.Z)({},u),{},{size:"middle",value:O.text,onSearch:function(h){if(e.onSearchBefore!=null){var F,Z={foreign:(F=e.attr)===null||F===void 0?void 0:F.foreign,value:h,field:e.attr};e.onSearchBefore(Z,function(te,U){var oe;(te.title==null||te.title=="")&&(te.title=(oe=e.attr)===null||oe===void 0?void 0:oe.title),I({isshow:!0,model:te,data:U})})}}})),(0,n.jsx)(Xe,{ismodal:!0,modelshow:z.isshow,model:z.model,data:z.data,closeedit:!0,commandShow:!1,selectType:"radio",closecard:!0,onModalChange:function(h,F){var Z=(0,_.Z)({},z);Z.isshow=h,console.log(Z),I(Z),l(F)},onSearchData:function(h,F){var Z;h.field=e.attr,h.foreign=(Z=e.attr)===null||Z===void 0?void 0:Z.foreign,e.onSearchData!=null&&e.onSearchData(h,F)}})]})}function ie(){var V=e.attr;return(V==null?void 0:V.type)=="string"&&(u.labelInValue=!0),(0,n.jsx)(Pn.Z,(0,_.Z)((0,_.Z)({},u),{},{size:"middle",value:r,onChange:t}))}function G(){return(0,n.jsx)(Wn.Z,{size:"default",checked:r,onChange:t})}function ce(){var V=e.attr,h=void 0,F=void 0;if(console.log(V),V.datatimetype&&(V.datatimetype.istime&&(h={format:V.datatimetype.timeformat}),F=V.datatimetype.dateformat),console.log(h),e.search){var Z;return(0,n.jsx)($n,{size:"middle",showTime:h,format:F,style:u.style,value:r,allowEmpty:[!0,!0],picker:(Z=e.options)===null||Z===void 0?void 0:Z.picker,onChange:t})}else return(0,n.jsx)(un.Z,(0,_.Z)((0,_.Z)({},u),{},{format:F,showTime:h,size:"middle",picker:"date",value:r,onChange:t}))}function de(){return(0,n.jsx)(Ln.Z,(0,_.Z)((0,_.Z)({},u),{},{value:r,onChange:t}))}function ve(){switch(u.texttype){case Ce.InputNumber:return de();case Ce.DatePicker:return ce();case Ce.Switch:return G();case Ce.Select:return ie();case Ce.Search:return P()}return(0,n.jsx)(Je.Z,(0,_.Z)((0,_.Z)({},u),{},{size:"middle",value:r,onChange:function(h){t(h.target.value)}}))}return ve()},Ye=pn,et=a(76570),Nt=null,nt=function(e){var f=new Map;f.set("string",[{label:"\u7B49\u4E8E",value:"="},{label:"\u5305\u542B",value:"like"},{label:"\u4E3A\u7A7A",value:"isnull"},{label:"\u4E0D\u4E3A\u7A7A",value:"isnotnull"},{label:"\u5DE6\u5339\u914D",value:"left"},{label:"\u53F3\u5339\u914D",value:"right"}]),f.set("int",[{label:"\u7B49\u4E8E",value:"="},{label:"\u5927\u4E8E",value:">"},{label:"\u5C0F\u4E8E",value:"<"}]),f.set("datetime",[{label:"\u8303\u56F4",value:"date"},{label:"\u5468",value:"week"},{label:"\u6708",value:"month"},{label:"\u5B63",value:"quarter"},{label:"\u5E74",value:"year"}]);var x=(0,s.useState)({value:"",attr:{type:"string"}}),u=(0,w.Z)(x,2),o=u[0],j=u[1],R=(0,s.useState)(""),z=(0,w.Z)(R,2),I=z[0],v=z[1],M=(0,s.useState)({type:"string"}),O=(0,w.Z)(M,2),E=O[0],N=O[1],q=(0,s.useState)({name:"*",type:"string",symbol:""}),r=(0,w.Z)(q,2),t=r[0],g=r[1],A=(0,s.useState)({picker:null}),l=(0,w.Z)(A,2),P=l[0],ie=l[1],G=[{label:"\u5168\u90E8",value:"*"}];e.fields!=null&&e.fields.forEach(function(h){if(h.issearch){var F,Z=(F=h.searchsymbol)!==null&&F!==void 0?F:f.get(h.type);h.type=="datetime"&&(Z=f.get(h.type)),h.type=="decimal"&&(Z=f.get("int")),h.foreign&&h.foreign.isfkey&&(Z=void 0),G.push({label:h.title,value:h.field,children:Z})}});function ce(){return(0,n.jsx)(kn.Z,{style:{width:"140px"},options:G,allowClear:!1,defaultValue:["*"],expandTrigger:"hover",onChange:function(F){var Z;console.log(F);var te=F[0],U=(Z=e.fields)===null||Z===void 0?void 0:Z.find(function(he){return he.field==te});if(g({name:te,symbol:F[1],type:U==null?void 0:U.type}),t.name!=te&&(j(Object.assign(o,{value:"",attr:U})),v(""),N(U),(U==null?void 0:U.type)=="datetime")){var oe=(0,_.Z)({},P);oe.picker=F[1],ie(oe)}}})}function de(){return(0,n.jsx)(Ye,{width:"240px",options:P,search:!0,name:t.name,attr:E,value:I,onChange:function(F){console.log(F),v(F),j({value:F,attr:o.attr})},onSearchBefore:function(F,Z){e.onSearchData&&e.onSearchData(F,function(te){Z(te.model,te)})},onSearchData:e.onSearchData})}function ve(){return(0,n.jsx)(we.Z,{style:{width:"70px"},type:"primary",icon:(0,n.jsx)(et.Z,{}),onClick:function(){console.log(o);var F=(0,We.Nz)(E,o.value);console.log(F);var Z={name:t.name,symbol:t.symbol,value:F};if(Z.name=="*"&&Z.value=="")e.onSearch();else{if(E.type=="datetime"&&o.value!=""&&(0,Le.isArray)(F)){var te=[];return o.value[0]!=null&&(Z.symbol=">=",Z.value=o.value[0],te.push(Z)),o.value[1]!=null&&te.push({name:t.name,symbol:"<=",value:o.value[1]}),e.onSearch(te)}e.onSearch(Z)}}})}function V(){return(0,n.jsxs)(Je.Z.Group,{compact:!0,children:[ce(),de(),ve()]})}return V()},tt=nt,at=function(){function J(){(0,yn.Z)(this,J),this.printText="\u6253\u5370",this.setText="\u8BBE\u7F6E",this.helpText="\u5E2E\u52A9",this.aboutText="\u5173\u4E8E"}return(0,Cn.Z)(J,[{key:"onPrint",value:function(f){}},{key:"onSet",value:function(f){}},{key:"onHelp",value:function(f){}},{key:"onAbout",value:function(f){}}]),J}(),it=function(e){var f=["add","create"],x=["remove","delete"],u=["update","edit"],o=["ImportData","import"],j=["ExportData","export"];function R(){var t,g=[],A=new Map;return(t=e.attrs)===null||t===void 0||t.forEach(function(l){if(l.issplit&&l.splitname!=null)if(A.has(l.splitname)){var P=A.get(l.splitname);P==null||P.push(l)}else A.set(l.splitname,[l]);else g.push(l)}),(0,n.jsx)(Ke.Z,{wrap:!0,children:g.map(function(l){if(A.has(l.command)){var P,ie=(0,n.jsx)(an.Z,{children:(P=A.get(l.command))===null||P===void 0?void 0:P.map(function(G,ce){return(0,n.jsx)(an.Z.Item,{children:(0,n.jsx)(Be,(0,_.Z)((0,_.Z)({},E(G)),{},{onClick:function(){return O(G.command,G)},toolbar:e}),ce)},ce)})});return(0,n.jsx)(Be,(0,_.Z)((0,_.Z)({},E(l)),{},{icon:(0,n.jsx)(Zn.Z,{}),ismenu:!0,menu:ie,onClick:function(){return O(l.command,l)},toolbar:e}))}else return(0,n.jsx)(Be,(0,_.Z)((0,_.Z)({},E(l)),{},{onClick:function(){return O(l.command,l)},toolbar:e}))})})}function z(t){return e.isselectrow?e.onCommandDisabled!=null?e.onCommandDisabled(t):e.selectcount==1&&t.isselectrow||e.selectcount!=null&&e.selectcount>1&&t.isselectrow&&t.selectmultiple?!1:t.isselectrow:!1}function I(){if(e.helpShow!=null&&e.helpShow!=!1){var t,g,A,l,P,ie,G,ce,de,ve,V=(0,s.useState)({isprint:(t=(g=e.helpShow)===null||g===void 0?void 0:g.isprint)!==null&&t!==void 0?t:!1,isset:(A=(l=e.helpShow)===null||l===void 0?void 0:l.isset)!==null&&A!==void 0?A:!1,ishelp:(P=(ie=e.helpShow)===null||ie===void 0?void 0:ie.ishelp)!==null&&P!==void 0?P:!1,isabout:(G=(ce=e.helpShow)===null||ce===void 0?void 0:ce.isabout)!==null&&G!==void 0?G:!1,wvh:(de=(ve=e.helpShow)===null||ve===void 0?void 0:ve.wvh)!==null&&de!==void 0?de:new at}),h=(0,w.Z)(V,2),F=h[0],Z=h[1];return(0,n.jsx)(Ke.Z,{wrap:!0,children:v(F)})}}function v(t){var g=[];if(t.isprint){var A;g.push((0,n.jsx)(Be,{title:(A=t.wvh)===null||A===void 0?void 0:A.printText,name:"print",shape:"circle",icon:(0,n.jsx)(jn.Z,{}),onClick:O}))}if(t.isset){var l;g.push((0,n.jsx)(Be,{title:(l=t.wvh)===null||l===void 0?void 0:l.setText,name:"set",shape:"circle",icon:(0,n.jsx)(En.Z,{}),onClick:O}))}if(t.ishelp){var P;g.push((0,n.jsx)(Be,{title:(P=t.wvh)===null||P===void 0?void 0:P.helpText,name:"help",shape:"circle",icon:(0,n.jsx)(bn.Z,{}),onClick:O}))}if(t.isabout){var ie;g.push((0,n.jsx)(Be,{title:(ie=t.wvh)===null||ie===void 0?void 0:ie.aboutText,name:"about",shape:"circle",icon:(0,n.jsx)(wn.Z,{}),onClick:O}))}return g.length>0&&g.unshift((0,n.jsx)(tn.Z,{type:"vertical"})),g.map(function(G){return G})}function M(){if(e.searchShow!=null&&e.searchShow!=!1)return(0,n.jsx)(tt,(0,_.Z)({},e.searchShow))}var O=function(g,A){e.onClick!=null&&e.onClick(g,A)};function E(t){var g,A={name:t.command,title:t.title,text:t.name,danger:!1,block:!1,type:"default",size:"default",shape:"",loading:!1,icon:"",ghost:!1,disabled:!1};return A.disabled=(g=z(t))!==null&&g!==void 0?g:!1,A=N(A),e.iscircle&&(A.shape="circle",A.title=A.text,A.text=""),A}function N(t){return f.includes(t.name)&&(t.type="primary",t.icon=(0,n.jsx)(Fn.Z,{component:Dn.Z})),x.includes(t.name)&&(t.type="danger",t.icon=(0,n.jsx)(Tn.Z,{})),u.includes(t.name)&&(t.icon=(0,n.jsx)(Rn.Z,{})),o.includes(t.name)&&(t.icon=(0,n.jsx)(Mn.Z,{})),j.includes(t.name)&&(t.icon=(0,n.jsx)(Bn.Z,{})),t.icon==""&&(t.icon=(0,n.jsx)(In.Z,{})),t}var q=function(g){return g.length==3?(0,n.jsxs)(se.Z,{gutter:[8,8],children:[(0,n.jsx)(re.Z,{span:10,children:(0,n.jsx)(se.Z,{justify:"start",children:g[0]})}),(0,n.jsx)(re.Z,{span:8,children:(0,n.jsx)(se.Z,{justify:"end",children:g[1]})}),(0,n.jsx)(re.Z,{span:6,children:(0,n.jsx)(se.Z,{justify:"end",children:g[2]})})]}):g.length==2?(0,n.jsxs)(se.Z,{gutter:[8,8],children:[(0,n.jsx)(re.Z,{span:12,children:(0,n.jsx)(se.Z,{justify:"start",children:g[0]})}),(0,n.jsx)(re.Z,{span:12,children:(0,n.jsx)(se.Z,{justify:"end",children:g[1]})})]}):g.length==1?(0,n.jsx)(se.Z,{gutter:[8,8],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(se.Z,{justify:"start",children:g[0]})})}):(0,n.jsx)(n.Fragment,{})};function r(){var t=[];return e.searchShow!=null&&e.searchShow!=!1&&t.push((0,n.jsx)(re.Z,{children:M()})),e.commandShow!=null&&e.commandShow!=!1&&t.push((0,n.jsx)(re.Z,{children:R()})),e.helpShow!=null&&e.helpShow!=!1&&t.push((0,n.jsx)(re.Z,{children:I()})),e.isclosecard?q(t):(0,n.jsx)(Me.Z,{children:q(t)})}return r()},sn=it,Kt=a(9715),$e=a(22712),lt=He.Z.TabPane,ut=function(e){var f,x=$e.Z.useForm(),u=(0,w.Z)(x,1),o=u[0],j=(0,s.useState)(e.title),R=(0,w.Z)(j,2),z=R[0],I=R[1],v=(0,s.useState)((f=e.isshow)!==null&&f!==void 0?f:!1),M=(0,w.Z)(v,2),O=M[0],E=M[1],N=(0,s.useState)(Z(e.attr)),q=(0,w.Z)(N,2),r=q[0],t=q[1],g=(0,s.useState)(function(){return U(e.values)}),A=(0,w.Z)(g,2),l=A[0],P=A[1],ie=(0,s.useState)(!1),G=(0,w.Z)(ie,2),ce=G[0],de=G[1],ve=(0,s.useState)(!1),V=(0,w.Z)(ve,2),h=V[0],F=V[1];(0,s.useEffect)(function(){console.log(e.values),e.values!=null?P(U(e.values)):oe()},[e.values]),(0,s.useEffect)(function(){t(Z(e.attr))},[e.attr]);function Z(m){var y,i;return{items:m==null||(y=m.fields)===null||y===void 0?void 0:y.filter(function(S){return S.visible&&S.isedit}),models:m==null||(i=m.childmodels)===null||i===void 0?void 0:i.filter(function(S){return S.propertyname==null&&(S.propertyname=S.name),S.visible})}}function te(){var m,y=[];return(m=r.items)===null||m===void 0||m.forEach(function(i){var S=he(e.attr,i);e.onInitTextBox!=null&&e.onInitTextBox(i,txtprops),y.push((0,n.jsx)(re.Z,{span:8,children:(0,n.jsx)($e.Z.Item,(0,_.Z)((0,_.Z)({},S),{},{children:(0,n.jsx)(Ye,{attr:i,onSearchBefore:function(Q,ee){e.onSearchData!=null&&e.onSearchData(Q,function(ne){ee(ne.model,ne)})},onSearchData:function(Q,ee){e.onSearchData&&e.onSearchData(Q,ee)},children:l})}),i.field)}))}),e.onInitFormed!=null&&(o.setFieldDisabled=function(i,S){var K;(K=r.items)===null||K===void 0||K.forEach(function(Q){var ee;((ee=Q.field)===null||ee===void 0?void 0:ee.toLocaleLowerCase())==i.toLocaleLowerCase()&&(Q.disabled=S)}),t(r)},o.setTitle=function(i){I(i)},o.show=function(){E(!0)},o.hide=function(){E(!1)},o.setValues=function(i){P(U(i))},o.clear=function(){oe()},o.setHideSearch=function(i){F(i)},o.setHideToolbar=function(i){de(i)},e.onInitFormed(o)),y}function U(m){var y;return m==null&&(m={}),o.setFieldsValue(m),r.models!=null&&((y=r.models)===null||y===void 0?void 0:y.length)>0&&(console.log(r),r.models.forEach(function(i){m[i.propertyname]?m[i.propertyname].total=m[i.propertyname].length:(m[i.propertyname]=[],m[i.propertyname].total=0),i.removeRows=[]})),m}function oe(){var m;o.resetFields();var y={};(m=r.models)===null||m===void 0||m.forEach(function(i){y[i.propertyname]||(y[i.propertyname]=[],y[i.propertyname].total=0)}),P(y)}function he(m,y){var i={};i.name=y.field,i.label=y.title;var S=Ze(y);return y.disabled||(i.rules=S),e.onInitItem!=null&&e.onInitItem(y,i),i}function Ze(m){var y,i=[];if(m.required&&i.push({required:m.required}),(y=m.length)!==null&&y!==void 0?y:0>0){var S;i.push({max:(S=m.length)!==null&&S!==void 0?S:500,type:(0,We.mc)(m.type)})}return e.onFieldRules!=null&&(i=e.onFieldRules(m,i)),i}var ge=function(y){var i,S=Object.assign({},l);for(var K in y)S[K]=y[K];return r.models!=null&&((i=r.models)===null||i===void 0?void 0:i.length)>0&&r.models.forEach(function(Q){var ee;(ee=Q.removeRows)===null||ee===void 0||ee.forEach(function(ne){ne.modelState=3,S[Q.propertyname].push(ne)}),S[Q.propertyname]!=null&&S[Q.propertyname].forEach(function(ne){ne.isnew&&(ne.id=null)})}),S};function ye(){return(0,n.jsx)($e.Z,{labelAlign:"left",form:o,onFinish:function(y){var i=ge(y);console.log(i),o.onFinish!=null&&o.onFinish(i),e.onFinish!=null&&e.onFinish(i)},scrollToFirstError:!0,initialValues:e.values,children:(0,n.jsx)(se.Z,{gutter:24,children:te()})})}function me(){var m;if(r.models!=null&&((m=r.models)===null||m===void 0?void 0:m.length)>0){var y;return(0,n.jsx)(He.Z,{defaultActiveKey:"0",children:(y=r.models)===null||y===void 0?void 0:y.map(function(i,S){var K;return(0,n.jsx)(lt,{tab:i.title,children:(0,n.jsx)(Xe,{model:i,data:{rows:l[i.propertyname],total:(K=l[i.propertyname])===null||K===void 0?void 0:K.total},iscirclebutton:!0,closetoolbar:ce,closesearch:h,closecard:!0,onSearchData:function(ee){e.onSearchData!=null&&(ee.parent=l,ee.childmodel=i,e.onSearchData(ee,function(ne){var Ee=Object.assign({},l);Ee[i.propertyname]=ne.rows,Ee[i.propertyname].total=ne.total,P(Ee)}))},onDataChange:function(ee,ne,Ee){console.log(ee,ne);var Fe=Object.assign({},l);Fe[i.propertyname]=ee.rows,Fe[i.propertyname].total=ee.total,console.log(Fe),Ee=="remove"&&ne.forEach(function(be){be&&!be.isnew&&i.removeRows.push(be)}),P(Fe)}})},S)})})}return(0,n.jsx)(n.Fragment,{})}function X(){return e.ismodal?(0,n.jsxs)(Qe,{title:z,width:1100,visible:O,onCancel:function(){return E(!1)},onOk:function(){o.submit()},children:[(0,n.jsx)(Me.Z,{children:ye()}),me()]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Me.Z,{title:z,children:ye()}),me()]})}return X()},fn=ut,cn=a(38535),ot=a(73218),Ht=a(34669),rt=a(82833),Gt=a(17462),qe=a(76772),_e=a(3182),vn=a(91220),dt=a(94043),Ae=a.n(dt),st=a(43347),Jt=a(35556),hn=a(97880),ft=hn.Z.Step,ct=function(e){var f,x,u=(0,s.useState)((f=e.currentStep)!==null&&f!==void 0?f:0),o=(0,w.Z)(u,2),j=o[0],R=o[1],z=(0,s.useState)((x=e.isShow)!==null&&x!==void 0?x:!1),I=(0,w.Z)(z,2),v=I[0],M=I[1];(0,s.useEffect)(function(){var r;M((r=e.isShow)!==null&&r!==void 0?r:!1)},[e.isShow]),(0,s.useEffect)(function(){var r;if(R((r=e.currentStep)!==null&&r!==void 0?r:0),e.onChange){var t;e.onChange((t=e.currentStep)!==null&&t!==void 0?t:0)}},[e,e.currentStep]);function O(r){return e.onCurrentStepComponent?e.onCurrentStepComponent(r):(0,n.jsx)(fn,{attr:e.attr,ismodal:!1})}function E(){var r;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(hn.Z,{current:j,onChange:function(g){R(g),e.onChange&&e.onChange(g)},children:(r=e.stepItem)===null||r===void 0?void 0:r.map(function(t){return(0,n.jsx)(ft,(0,_.Z)({},t))})}),(0,n.jsx)(tn.Z,{}),O(j)]})}function N(r){M(r),e.onShowChange&&e.onShowChange(r)}function q(){if(e.isModal){var r={onOk:function(){N(!1)},onCancel:function(){N(!1)}};return e.closeOk&&(r.footer=!1),(0,n.jsx)(Qe,(0,_.Z)((0,_.Z)({maskClosable:!1,destroyOnClose:!0,title:e.title,width:900,visible:v},r),{},{children:E()}))}return e.isCard?(0,n.jsx)(Me.Z,{title:e.title,bordered:!1,children:E()}):E()}return q()},vt=ct,pe=a(54701),ht=a(58602),mn=a(32059);function gn(J,e,f){var x=J.map(function(I,v){return Object.assign({},{key:I.key,title:I.title,position:String.fromCharCode(65+v)+1})}).reduce(function(I,v){return Object.assign({},I,(0,mn.Z)({},v.position,{key:v.key,v:v.title}))},{}),u=e.map(function(I,v){return J.map(function(M,O){return Object.assign({},{content:I[M.key],position:String.fromCharCode(65+O)+(v+2)})})}).reduce(function(I,v){return I.concat(v)}).reduce(function(I,v){return Object.assign({},I,(0,mn.Z)({},v.position,{v:v.content}))},{}),o=Object.assign({},x,u),j=Object.keys(o),R="".concat(j[0],":").concat(j[j.length-1]),z={SheetNames:["mySheet"],Sheets:{mySheet:Object.assign({},o,{"!ref":R,"!cols":[{wpx:45},{wpx:100},{wpx:200},{wpx:80},{wpx:150},{wpx:100},{wpx:300},{wpx:300}]})}};pe.NC(z,f)}function mt(J,e,f,x,u){return en.apply(this,arguments)}function en(){return en=(0,_e.Z)(Ae().mark(function J(e,f,x,u,o){var j,R;return Ae().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:f>0&&(j=[],e.fields.forEach(function(v){v.visible&&j.push({title:v.title,key:v.field,item:v})}),R=Object.assign({},x),R.page=1,R.size=1e3,u(R).then(function(v){if(v!=null&&v.success&&v.data&&v.data.rows){var M=v.data.rows;for(var O in M)for(var E in j){var N=M[O][j[E].key],q=rn(N,j[E].item,M[O]);M[O][j[E].key]=q!=null?q:""}gn(j,M,o)}}));case 1:case"end":return I.stop()}},J)})),en.apply(this,arguments)}var gt=function(e){var f,x=(0,s.useState)(0),u=(0,w.Z)(x,2),o=u[0],j=u[1],R=(0,s.useState)((f=e.isShow)!==null&&f!==void 0?f:!1),z=(0,w.Z)(R,2),I=z[0],v=z[1],M=(0,s.useState)(0),O=(0,w.Z)(M,2),E=O[0],N=O[1],q=(0,s.useState)({model:void 0,data:{rows:[],total:0}}),r=(0,w.Z)(q,2),t=r[0],g=r[1],A=(0,s.useState)(K(e.attr)),l=(0,w.Z)(A,2),P=l[0],ie=l[1],G=(0,s.useState)({message:"",description:"",type:"success",count:0}),ce=(0,w.Z)(G,2),de=ce[0],ve=ce[1],V=(0,s.useState)(null),h=(0,w.Z)(V,2),F=h[0],Z=h[1],te=(0,s.useState)({model:null,rows:[],total:0}),U=(0,w.Z)(te,2),oe=U[0],he=U[1],Ze=(0,s.useState)(!0),ge=(0,w.Z)(Ze,2),ye=ge[0],me=ge[1],X=(0,s.useState)(void 0),m=(0,w.Z)(X,2),y=m[0],i=m[1];function S(){j(0),N(0),g({model:void 0,data:{rows:[],total:0}}),ve({message:"",description:"",type:"success",count:0}),Z(null),he({model:null,rows:[],total:0}),me(!0),i(void 0)}function K(D){var c;return(c=D.fields)===null||c===void 0?void 0:c.filter(function(C){return C.visible&&!C.disabled})}(0,s.useEffect)(function(){v(e.isShow)},[e.isShow]),(0,s.useEffect)(function(){ie(K(e.attr))},[e.attr]);var Q=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return new Promise(function(C){setTimeout(function(){C(!0)},c)})};function ee(){var D={title:"\u4E0A\u4F20\u5BFC\u5165\u6587\u4EF6"},c={title:"\u8BBE\u7F6E\u5BFC\u5165\u6620\u5C04"},C={title:"\u5BFC\u5165\u6570\u636E"},L=[D,c,C];return L}function ne(D){var c={fields:[]};if(D.length>0)for(var C in D[0]){var L;(L=c.fields)===null||L===void 0||L.push({field:C,title:C,type:"string",visible:!0,sorter:!1})}return c}function Ee(D){var c=D.rowcount,C=D.data;if(c>0){N(c);for(var L=ne(C),H=[],B=0;B<6;B++)H.push(C[B]);g({model:L,data:{rows:H,total:5}})}}function Fe(){var D,c,C=new Map,L=new Map;(D=t.model)===null||D===void 0||(c=D.fields)===null||c===void 0||c.forEach(function(p,W){C.set(W,p.title)});var H=[];P.forEach(function(p,W){var fe,Se;L.set(W,p.title);var $=p.foreign&&p.foreign.isfkey?"Name":"",xe=(fe=t.model)===null||fe===void 0||(Se=fe.fields)===null||Se===void 0?void 0:Se.find(function(Ge){return Ge.field==p.field||Ge.field==p.title}),Te=void 0;if(xe==null||xe==null){var Ie;W<((Ie=t.model)===null||Ie===void 0?void 0:Ie.fields.length)&&(Te=W),H.push({id:W,source:Te,target:W,defaultValue:"",foreignMap:$})}else{var Re=(0,vn.Z)(C.entries()),Ve;try{for(Re.s();!(Ve=Re.n()).done;){var Ne=Ve.value;if(xe.title==Ne[1]||xe.field==Ne[1]){Te=Ne[0];break}}}catch(Ge){Re.e(Ge)}finally{Re.f()}H.push({id:W,source:Te,target:W,defaultValue:"",foreignMap:$})}});var B=[{field:"source",title:"\u6765\u6E90\u5217\u540D",type:"string",comvtp:{isvtp:!0,items:C},visible:!0,sorter:!1},{field:"target",title:"\u76EE\u6807\u5217\u540D",type:"string",comvtp:{isvtp:!0,items:L},visible:!0,sorter:!1,isedit:!1},{field:"defaultValue",title:"\u9ED8\u8BA4\u503C",type:"string",visible:!0,sorter:!1},{field:"foreignMap",title:"\u5916\u5173\u8054\u6620\u5C04",type:"string",visible:!0,sorter:!1}];he({model:{fields:B,isadd:!1,isedit:!0,isremove:!1},rows:H,total:H.length})}function be(D){var c={};for(var C in oe.rows){var L,H,B=oe.rows[C],p=(L=t.model)===null||L===void 0?void 0:L.fields[B.source];if(!((p==null||p==null)&&B.defaultValue=="")){var W=P[B.target];if(!(W==null||W==null)){if(B.defaultValue!=null&&B.defaultValue!=""){var fe;c[W.field]=B.defaultValue,(fe=W.foreign)!==null&&fe!==void 0&&fe.isfkey&&(c[W.field]=B[W.field]);continue}var Se=p.field,$=D[Se];if(W.required&&($==null||$==null||$=="")){k(c,"\u5BFC\u5165\u6570\u636E".concat(p.field,"\u4E3A\u7A7A\u503C\uFF0C\u6620\u5C04\u9879").concat(W.title,"\u4E0D\u80FD\u4E3A\u7A7A\uFF0C\u8BF7\u4FEE\u6539Excel\u540E\u91CD\u8BD5\uFF01"),0);return}if(!($==null||$==null||$=="")){if(W!=null&&W.comvtp&&W.comvtp.isvtp){var xe=(0,vn.Z)(W.comvtp.items.entries()),Te;try{for(xe.s();!(Te=xe.n()).done;){var Ie=Te.value;if($==Ie[1]){$=Ie[0];break}}}catch(Ve){xe.e(Ve)}finally{xe.f()}}if((H=W.foreign)!==null&&H!==void 0&&H.isfkey&&y!=null&&y.has(W.field)){var Re=y.get(W.field);$=Re[$]}c[W.field]=$}}}}return c}function Pe(D){var c=new Map;return oe.rows.forEach(function(C){var L,H=(L=t.model)===null||L===void 0?void 0:L.fields[C.source];if(H){var B,p=P[C.target],W=C.foreignMap==""?"Name":C.foreignMap;if((B=p.foreign)!==null&&B!==void 0&&B.isfkey&&C.defaultValue==""){c.has(p.field)||c.set(p.field,new Map);var fe=c.get(p.field);for(var Se in D){var $=D[Se],xe=$[H.field];xe!=null&&xe!=""&&!fe.has(xe)&&(fe==null||fe.set(xe,W))}}}}),c}function ze(D){var c=Pe(D);if(c.size==0){me(!1),ve({message:"\u8BF7\u70B9\u51FB\u5F00\u59CB\u5BFC\u5165",description:"\u5BFC\u5165\u6570\u636E\u51C6\u5907\u5B8C\u6210......",type:"info",count:0});return}var C="";c.forEach(function(L,H){var B=P.find(function($){return $.field==H}),p=P.find(function($){return $.type=="string"}).searchsymbol.find(function($){return $.label=="\u7B49\u4E8E"}).value,W=[],fe="";L.forEach(function($,xe){fe=$.toLowerCase(),W.push({name:$,symbol:p,value:xe,relation:"||"})});var Se={field:B,foreign:B.foreign,whereList:W};e.onSearchData&&(Q(200),e.onSearchData(Se,function($){if($&&$.rows.length>0)if($.rows.length==L.size){console.log(L);for(var xe in $.rows){var Te=$.rows[xe][fe];L.has(Te)&&(L[Te]=$.rows[xe].id)}i(c),me(!1),console.log(de.description),ve({message:"\u8BF7\u70B9\u51FB\u5F00\u59CB\u5BFC\u5165",description:"\u5BFC\u5165\u6570\u636E\u51C6\u5907\u5B8C\u6210,\u5DF2\u6620\u5C04".concat(B==null?void 0:B.title,"\u6570\u636E").concat($.total,`\u9879\u3002
`),type:"info",count:0})}else L.forEach(function(Ie,Re){var Ve=$.rows.find(function(Ne){return Ne[fe]==Re});C+="".concat(B==null?void 0:B.title,"\u4E2D\u672A\u627E\u5230").concat(fe,"\u4E3A").concat(Re,`\u7684\u6570\u636E\uFF0C\u8BF7\u4FEE\u6539Excel\u540E\u91CD\u8BD5!
`),Ve==null&&k($.rows,C,0)});else C+="".concat(B==null?void 0:B.title,"\u4E2D\u672A\u627E\u5230").concat(fe,"\u4E3A").concat(W[0].value,`\u7684\u6570\u636E\uFF0C\u8BF7\u4FEE\u6539Excel\u540E\u91CD\u8BD5!
`),k($.rows,C,0)}))})}function le(D){if(F==null||F.data==null){ke.Z.error({content:(0,n.jsx)("div",{children:"\u5BFC\u5165\u6570\u636E\u672A\u4E0A\u4F20\uFF0C\u4E0D\u80FD\u5BFC\u5165\uFF01"})});return}var c=F.data;if(oe.rows.length<=0){ke.Z.error({content:(0,n.jsx)("div",{children:"Excel\u4E8E\u6570\u636E\u6620\u5C04\u5173\u7CFB\u672A\u8BBE\u7F6E\u4E0D\u80FD\u5BFC\u5165\uFF01"})});return}if(!ye){if(D==c.length){ve({message:"\u5BFC\u5165\u6570\u636E\u5B8C\u6210",description:"",type:"success",count:D}),me(!0);return}var C=be(c[D]);C!=null&&d(C,function(L,H){Y(C,L,H,D)})}}function Y(D,c,C,L){c?(L++,ve({message:"\u5BFC\u5165\u6210\u529F",description:JSON.stringify(D),type:"success",count:L}),Q(200),le(L)):k(D,C,L)}function d(D,c){return b.apply(this,arguments)}function b(){return b=(0,_e.Z)(Ae().mark(function D(c,C){return Ae().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:e.onAdd&&e.onAdd("add",c).then(function(){var B=(0,_e.Z)(Ae().mark(function p(W){return Ae().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:if(console.log(W),W.ok!=null&&W.ok==!1&&(me(!0),C(!1,W.statusText)),!(W!=null&&W.success)){Se.next=8;break}return Se.next=5,Q(200);case 5:C(!0),Se.next=10;break;case 8:me(!0),C(!1,W.message);case 10:case"end":return Se.stop()}},p)}));return function(p){return B.apply(this,arguments)}}());case 1:case"end":return H.stop()}},D)})),b.apply(this,arguments)}function k(D,c,C){var L={message:"\u5BFC\u5165\u51FA\u9519:"+JSON.stringify(D),description:c,type:"error",count:C,action:(0,n.jsx)(Ke.Z,{children:(0,n.jsx)(we.Z,{size:"small",type:"ghost",onClick:function(){if(e.form){var B=e.form;B.clear(),B.setHideSearch(!0),B.setTitle(e.title),B.show(),B.setValues(D),B.onFinish=function(p){console.log(p),B.hide(),d(p,function(W,fe){Y(p,W,fe,C)})}}},children:"\u4FEE\u6539"})})};ve(L)}function T(){var D={name:"file",accept:".xlsx, .xls",onChange:function(C){console.log(C);var L=new FileReader;L.onload=function(H){try{var B=H.target.result,p=pe.ij(B,{type:"binary"}),W=[];for(var fe in p.Sheets)if(p.Sheets.hasOwnProperty(fe)){W=pe.P6.sheet_to_json(p.Sheets[fe]);break}var Se={data:W,rowcount:W.length};Z(Se),Ee(Se)}catch($){nn.default.error("\u53D1\u751F\u9519\u8BEF\uFF01"),console.log($)}},L.readAsBinaryString(C.file.originFileObj)}};return(0,n.jsxs)(Me.Z,{children:[(0,n.jsx)(se.Z,{gutter:[8,8],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(qe.Z,{showIcon:!0,message:"\u4E0A\u4F20\u6587\u4EF6\u4E2D\u7684\u6570\u636E\u4E3A".concat(E,"\u884C"),type:"info",action:(0,n.jsx)(Ke.Z,{children:(0,n.jsx)(we.Z,{size:"small",type:"primary",onClick:function(){var C=[],L={};P.forEach(function(H){C.push({title:H.title,key:H.field}),L[H.field]=H.type+"(\u6570\u636E\u7C7B\u578B\u63D0\u793A\uFF0C\u5F55\u5165\u6570\u636E\u65F6\u8BF7\u5220\u9664)"}),gn(C,[L],e.title+"\u5BFC\u5165\u6A21\u677F.xlsx")},children:"\u4E0B\u8F7D\u5BFC\u5165\u6A21\u677F"})})})})}),(0,n.jsx)(se.Z,{gutter:[8,8],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsxs)(ht.default,(0,_.Z)((0,_.Z)({},D),{},{children:[(0,n.jsx)("p",{className:"ant-upload-drag-icon",children:(0,n.jsx)(st.Z,{})}),(0,n.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u62D6\u62FD\u6587\u4EF6\u4E0A\u4F20"})]}))})}),(0,n.jsx)(se.Z,{gutter:[8,8],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(Ue,{isclosecard:!0,attr:t.model,data:t.data})})}),(0,n.jsx)(se.Z,{gutter:[8,8],children:(0,n.jsx)(re.Z,{span:24,push:11,children:(0,n.jsx)(we.Z,{type:"primary",disabled:E<1,onClick:function(){j(o+1)},children:"\u4E0B\u4E00\u6B65"})})})]})}function ae(){var D={isselect:!1,closesearch:!0,closetoolbar:!0,closecard:!0,model:oe.model,data:{rows:oe.rows,total:oe.total},onDataChange:function(C){he((0,_.Z)((0,_.Z)({},oe),{},{rows:C.rows}))},onGetFieldToEdit:function(C,L){if(C.field=="defaultValue"){var H=L.target,B=P[H];return B}return C},onEditRowing:function(C,L,H){return H!=null&&(C.defaultValue=String(H)),!0},onSearchValueChange:function(C,L,H){H.text!=null&&(L.defaultValue=H.text)},onSearchData:e.onSearchData};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(Xe,(0,_.Z)({},D))})}),(0,n.jsxs)(se.Z,{gutter:[16,16],children:[(0,n.jsx)(re.Z,{span:12,push:10,children:(0,n.jsx)(we.Z,{type:"primary",onClick:function(){j(o+1)},children:"\u4E0B\u4E00\u6B65"})}),(0,n.jsx)(re.Z,{span:12,push:1,children:(0,n.jsx)(we.Z,{onClick:function(){j(o-1)},children:"\u4E0A\u4E00\u6B65"})})]})]})}function ue(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(qe.Z,{message:"\u6570\u636E\u5BFC\u5165\uFF0C\u603B\u9700\u8981\u5BFC\u5165".concat(E,"\u884C\uFF0C\u5DF2\u5BFC\u5165").concat(de.count,"\u884C"),type:"info"})})}),(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(rt.Z,{percent:parseInt((de.count/E*100).toString()),status:"active"})})}),(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:(0,n.jsx)(qe.Z,(0,_.Z)({},de))})}),(0,n.jsxs)(se.Z,{gutter:[8,8],children:[(0,n.jsx)(re.Z,{span:12,push:10,children:(0,n.jsx)(we.Z,{type:"primary",disabled:ye,onClick:function(){le(de.count)},children:"\u5F00\u59CB\u5BFC\u5165"})}),(0,n.jsx)(re.Z,{span:12,push:1,children:(0,n.jsx)(we.Z,{onClick:function(){j(o-1)},children:"\u4E0A\u4E00\u6B65"})})]})]})}function je(D){v(D),e.onShowChange&&e.onShowChange(D),D||S()}function De(){return(0,n.jsx)(vt,{title:"\u5BFC\u5165".concat(e.title,"\u6570\u636E"),closeOk:!0,isModal:!0,isShow:I,stepItem:ee(),currentStep:o,onChange:function(c){if(c==1&&Fe(),c==2&&F&&F.data){var C=F.data;ze(C)}j(c)},onCurrentStepComponent:function(c){return c==0?T():c==1?ae():c==2?ue():(0,n.jsx)(n.Fragment,{})},onShowChange:function(c){je(c)}})}return De()},St=gt,xt=function(e){var f=(0,s.useState)(!1),x=(0,w.Z)(f,2),u=x[0],o=x[1],j=(0,s.useState)(null),R=(0,w.Z)(j,2),z=R[0],I=R[1],v=(0,s.useState)(0),M=(0,w.Z)(v,2),O=M[0],E=M[1],N=(0,s.useState)([]),q=(0,w.Z)(N,2),r=q[0],t=q[1],g=(0,s.useState)(void 0),A=(0,w.Z)(g,2),l=A[0],P=A[1],ie=(0,s.useState)({rows:[],total:0}),G=(0,w.Z)(ie,2),ce=G[0],de=G[1],ve=(0,s.useState)(!1),V=(0,w.Z)(ve,2),h=V[0],F=V[1],Z=(0,s.useState)(null),te=(0,w.Z)(Z,2),U=te[0],oe=te[1],he=(0,s.useState)({page:1,size:10,whereList:[],sortList:[]}),Ze=(0,w.Z)(he,2),ge=Ze[0],ye=Ze[1],me=(0,s.useState)(1),X=(0,w.Z)(me,2),m=X[0],y=X[1];if((0,s.useEffect)(function(){P(void 0),I(null),E(0),t([]),de({rows:[],total:0}),i()},[e.controller]),l==null)return(0,n.jsx)(n.Fragment,{});function i(){if(console.log("waypage.init"),console.log(e),!e.init){var le,Y=(le=e.namespace)!==null&&le!==void 0?le:e.controller;console.log(Y+"model \u672A\u521B\u5EFA\u6216init\u65B9\u6CD5\u672A\u5B9E\u73B0\uFF0C\u4E0D\u80FD\u521D\u59CB\u5316page.");return}e.init().then(function(d){d!=null&&(d.success?(P(d.data),d.data.autoload&&S({},function(b){de(b)})):ee(d.message.message))})}function S(le,Y){le.foreign==null&&le.childmodel==null&&E(0),e.search(le).then(function(d){d!=null&&(o(!1),d!=null&&d.success?(d.data.rows==null&&(d.data.rows=[]),Y?Y(d.data):de(d.data)):ee(d.message.message))})}var K=function(Y){var d=null;Y.isselectrow&&(d=z),Y.selectmultiple&&(d=r),Q(Y,d)},Q=function(Y,d){e.execute(Y.command,d).then(function(b){console.log(b),b!=null&&b.success?(nn.default.success(Y.name+"\u5B8C\u6210"),(l==null?void 0:l.viewtype)!="form"&&(U&&U.hide(),S(ge,function(k){de(k)}))):ee(b.message.message)})};function ee(le){ke.Z.error({visible:!0,title:"\u51FA\u9519\u4E86",icon:(0,n.jsx)(ot.Z,{}),content:(0,n.jsx)("div",{children:le})})}function ne(le,Y){U!=null&&U.clear(),U.setHideSearch(!0),U.setTitle((l==null?void 0:l.title)+"-"+le.name),U.show(),Y&&(U.setValues(Y),U.setHideSearch(!1)),U.onFinish=function(d){console.log(d),Q(le,d)}}function Ee(le){var Y,d=le?{fields:l==null||(Y=l.fields)===null||Y===void 0?void 0:Y.filter(function(b){var k;return(k=b.issearch)!==null&&k!==void 0?k:!0}),onSearch:function(k){o(!0);var T={page:1,whereList:[]};k!=null&&((0,Le.isArray)(k)?T.whereList=k:T.whereList=[k]),ye(T),y(1),S(T,function(ae){de(ae)})},onSearchData:S}:!1;return(0,n.jsx)(sn,{attrs:l==null?void 0:l.commands,isselectrow:!0,selectcount:O,commandShow:!0,isshow:!le,onClick:function(k,T){if(console.log(k),k=="ImportData"){F(!0);return}if(k=="ExportData"){mt(l,ce.total,ge,e.search,e.title+".xlsx");return}if(k=="add"){if((l==null?void 0:l.viewtype)=="form"){U.onFinish=function(ae){console.log(ae),Q(T,ae)},U.submit();return}ne(T);return}if(k=="edit"){ne(T,z);return}K(T)},searchShow:d})}function Fe(){return(0,n.jsx)(Ue,{attr:l,data:ce,isselect:!0,isexpandable:!0,loading:u,current:m,onSelectRows:function(Y,d){t(d),E(d.length),I(Y)},onSearchData:function(Y,d){if(Y.parent&&Y.childmodel){S(Y,function(b){d(b)});return}o(!0),y(Y.page),Y.whereList=ge.whereList,ye(Y),S(Y,function(b){de(b)})},onExpandedRowTabPane:e.onExpandedRowTabPane,onRowDoubleClick:function(Y,d){var b,k=l==null||(b=l.commands)===null||b===void 0?void 0:b.find(function(T){return T.command=="edit"&&T.visible});k!=null&&ne(k,d)}})}function be(le){return(0,n.jsx)(fn,{attr:l,title:e.title,ismodal:le,onInitFormed:function(d){oe(d)},onSearchData:S})}function Pe(){return(l==null?void 0:l.viewtype)=="form"?ze():(0,n.jsxs)(cn.Oc,{title:e.title,children:[(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:Ee(!0)})}),(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:Fe()})}),(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:be(!0)})}),(0,n.jsx)(St,{title:e.title,isShow:h,attr:l,onAdd:e.execute,form:U,onShowChange:function(Y){F(Y),Y||S(ge)},onSearchData:S})]})}function ze(){return(0,n.jsxs)(cn.Oc,{title:e.title,children:[(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:Ee(!1)})}),(0,n.jsx)(se.Z,{gutter:[16,16],children:(0,n.jsx)(re.Z,{span:24,children:be(!1)})})]})}return Pe()};function yt(J,e){var f=e.controller;e.namespace!=null&&(f=e.namespace);var x=function(R){return{type:f+"/init",payload:R}},u=function(R){return{type:f+"/search",payload:R}},o=function(R){return{type:f+"/execute",payload:R}};return{dispatch:J,init:function(){return J(x({c:e.namespace+"/"+e.service+"/"+e.controller,s:e.service}))},search:function(R){var z=e.namespace+"/"+e.service+"/"+e.controller;return J(u({c:z,item:R,s:e.service}))},execute:function(R,z){var I=e.namespace+"/"+e.service+"/"+e.controller;return J(o({c:I,command:R,item:z,s:e.service}))}}}var Ct=(0,xn.$j)(function(){},yt)(xt)},20067:function(){}}]);
